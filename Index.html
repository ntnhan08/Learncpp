<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Học C++ từ cơ bản đến nâng cao</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#1e40af',
                        accent: '#60a5fa'
                    }
                }
            }
        }
    </script>
    <style>
        .code-editor {
            font-family: 'Courier New', monospace;
            background-color: #1e293b;
            color: #e2e8f0;
            border-radius: 0.5rem;
            padding: 1rem;
        }
        .progress-bar {
            height: 8px;
            border-radius: 4px;
            background-color: #e5e7eb;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background-color: #10b981;
            transition: width 0.5s ease-in-out;
        }
        .sidebar {
            height: calc(100vh - 4rem);
            overflow-y: auto;
        }
        .module-item {
            transition: all 0.3s ease;
        }
        .module-item:hover {
            background-color: #f3f4f6;
        }
        .active-module {
            background-color: #dbeafe;
            border-left: 4px solid #3b82f6;
        }
        .quiz-option {
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .quiz-option:hover {
            background-color: #f3f4f6;
        }
        .correct-answer {
            background-color: #d1fae5;
            border-color: #10b981;
        }
        .wrong-answer {
            background-color: #fee2e2;
            border-color: #ef4444;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center">
                <i class="fas fa-code text-primary text-2xl mr-3"></i>
                <h1 class="text-xl font-bold text-gray-800">Học C++</h1>
            </div>
            <div class="flex items-center space-x-4">
                <div class="hidden md:block">
                    <div class="text-sm text-gray-600">Tiến độ học tập</div>
                    <div class="progress-bar w-40">
                        <div class="progress-fill" id="overall-progress" style="width: 0%"></div>
                    </div>
                </div>
                <button id="dark-mode-toggle" class="p-2 rounded-full bg-gray-200 hover:bg-gray-300">
                    <i class="fas fa-moon text-gray-700"></i>
                </button>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 py-6 flex flex-col md:flex-row">
        <!-- Sidebar -->
        <div class="w-full md:w-1/4 lg:w-1/5 mb-6 md:mb-0 md:pr-4">
            <div class="bg-white rounded-lg shadow sidebar">
                <div class="p-4 border-b">
                    <h2 class="font-bold text-lg text-gray-800">Nội dung khóa học</h2>
                </div>
                <nav class="p-2">
                    <ul id="module-list" class="space-y-1">
                        <!-- Module items will be generated by JavaScript -->
                    </ul>
                </nav>
            </div>
        </div>

        <!-- Main Content -->
        <main class="w-full md:w-3/4 lg:w-4/5 md:pl-4">
            <!-- Home Page -->
            <div id="home-page" class="bg-white rounded-lg shadow p-6">
                <div class="text-center py-8">
                    <h1 class="text-3xl font-bold text-gray-800 mb-4">Học C++ từ cơ bản đến nâng cao</h1>
                    <p class="text-gray-600 max-w-2xl mx-auto mb-8">
                        Khóa học toàn diện giúp bạn làm chủ ngôn ngữ lập trình C++ từ những kiến thức cơ bản nhất đến các kỹ thuật nâng cao, kèm theo hệ thống bài tập và chấm điểm tự động.
                    </p>
                    <button id="start-learning" class="bg-primary hover:bg-secondary text-white font-bold py-3 px-8 rounded-lg transition duration-300">
                        Bắt đầu học
                    </button>
                </div>
                
                <div class="mt-10">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Tiến độ học tập của bạn</h2>
                    <div class="bg-gray-100 p-4 rounded-lg">
                        <div class="flex justify-between mb-2">
                            <span class="text-sm font-medium text-gray-700">Hoàn thành: <span id="progress-percent">0%</span></span>
                            <span class="text-sm text-gray-600"><span id="completed-modules">0</span>/12 mục</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="home-progress-bar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-10 grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                        <div class="flex items-center mb-3">
                            <i class="fas fa-book text-blue-500 text-xl mr-3"></i>
                            <h3 class="font-bold text-gray-800">Học lý thuyết</h3>
                        </div>
                        <p class="text-gray-600 text-sm">Nắm vững kiến thức với các bài học chi tiết, ví dụ minh họa và code mẫu.</p>
                    </div>
                    <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                        <div class="flex items-center mb-3">
                            <i class="fas fa-pencil-alt text-green-500 text-xl mr-3"></i>
                            <h3 class="font-bold text-gray-800">Làm bài tập</h3>
                        </div>
                        <p class="text-gray-600 text-sm">Thực hành với hệ thống bài tập đa dạng và chấm điểm tự động.</p>
                    </div>
                    <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                        <div class="flex items-center mb-3">
                            <i class="fas fa-chart-line text-purple-500 text-xl mr-3"></i>
                            <h3 class="font-bold text-gray-800">Theo dõi tiến độ</h3>
                        </div>
                        <p class="text-gray-600 text-sm">Theo dõi sự tiến bộ của bạn với bảng thống kê chi tiết.</p>
                    </div>
                </div>
            </div>

            <!-- Module Detail Page -->
            <div id="module-page" class="bg-white rounded-lg shadow p-6 hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 id="module-title" class="text-2xl font-bold text-gray-800">Tiêu đề mục học</h2>
                    <button id="module-exercises-btn" class="bg-primary hover:bg-secondary text-white font-bold py-2 px-4 rounded transition duration-300">
                        Làm bài tập
                    </button>
                </div>
                
                <div id="module-content" class="prose max-w-none">
                    <!-- Module content will be loaded here -->
                </div>
            </div>

            <!-- Exercises Page -->
            <div id="exercises-page" class="bg-white rounded-lg shadow p-6 hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 id="exercises-title" class="text-2xl font-bold text-gray-800">Bài tập</h2>
                    <div class="flex space-x-2">
                        <button id="submit-exercises" class="bg-primary hover:bg-secondary text-white font-bold py-2 px-4 rounded transition duration-300">
                            Nộp bài
                        </button>
                        <button id="back-to-module" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded transition duration-300">
                            Quay lại
                        </button>
                    </div>
                </div>
                
                <div id="exercises-container">
                    <!-- Exercises will be loaded here -->
                </div>
            </div>

            <!-- Progress Board Page -->
            <div id="progress-page" class="bg-white rounded-lg shadow p-6 hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Bảng tiến độ học tập</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-sm text-gray-600">Mục đã học</p>
                                <h3 class="text-2xl font-bold text-gray-800" id="stats-modules">0</h3>
                            </div>
                            <i class="fas fa-book-open text-blue-500 text-2xl"></i>
                        </div>
                    </div>
                    <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-sm text-gray-600">Bài tập đã làm</p>
                                <h3 class="text-2xl font-bold text-gray-800" id="stats-exercises">0</h3>
                            </div>
                            <i class="fas fa-pencil-alt text-green-500 text-2xl"></i>
                        </div>
                    </div>
                    <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-sm text-gray-600">Điểm trung bình</p>
                                <h3 class="text-2xl font-bold text-gray-800" id="stats-average">0.0</h3>
                            </div>
                            <i class="fas fa-star text-purple-500 text-2xl"></i>
                        </div>
                    </div>
                    <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-200">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-sm text-gray-600">Tỷ lệ hoàn thành</p>
                                <h3 class="text-2xl font-bold text-gray-800" id="stats-completion">0%</h3>
                            </div>
                            <i class="fas fa-trophy text-yellow-500 text-2xl"></i>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-100 p-4 rounded-lg mb-8">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">Tiến độ tổng thể</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="stats-progress-bar" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="bg-white border rounded-lg overflow-hidden">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mục học</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Trạng thái</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Điểm số</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ngày hoàn thành</th>
                            </tr>
                        </thead>
                        <tbody id="progress-table-body" class="bg-white divide-y divide-gray-200">
                            <!-- Progress data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Dữ liệu mẫu cho các mục học
        const courseModules = [
            {
                id: 1,
                title: "Giới thiệu C++ và môi trường",
                status: "completed",
                content: `
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Giới thiệu về C++</h3>
                    <p class="mb-4">C++ là ngôn ngữ lập trình hướng đối tượng, được phát triển từ ngôn ngữ C. Nó cung cấp các tính năng mạnh mẽ cho lập trình hệ thống và ứng dụng.</p>
                    
                    <h4 class="text-lg font-bold text-gray-800 mb-2">Cài đặt môi trường</h4>
                    <p class="mb-4">Để lập trình C++, bạn cần cài đặt một trình biên dịch (compiler) như GCC, Clang hoặc Visual C++.</p>
                    
                    <h4 class="text-lg font-bold text-gray-800 mb-2">Chương trình C++ đầu tiên</h4>
                    <p class="mb-4">Dưới đây là chương trình "Hello World" trong C++:</p>
                    <div class="code-editor mb-4">
                        <pre><code>#include &lt;iostream&gt;
using namespace std;

int main() {
    cout &lt;&lt; "Hello, World!" &lt;&lt; endl;
    return 0;
}</code></pre>
                    </div>
                    
                    <h4 class="text-lg font-bold text-gray-800 mb-2">Giải thích</h4>
                    <ul class="list-disc pl-5 mb-4 space-y-2">
                        <li><code>#include &lt;iostream&gt;</code>: Thư viện nhập/xuất chuẩn của C++</li>
                        <li><code>using namespace std</code>: Sử dụng không gian tên std để không cần gọi std::</li>
                        <li><code>int main()</code>: Hàm chính, điểm bắt đầu của chương trình</li>
                        <li><code>cout</code>: Đối tượng xuất dữ liệu ra màn hình</li>
                        <li><code>return 0</code>: Kết thúc chương trình với mã thành công</li>
                    </ul>
                `,
                exercises: [
                    {
                        id: 1,
                        type: "quiz",
                        question: "Hàm nào là hàm chính trong chương trình C++?",
                        options: [
                            "start()",
                            "main()",
                            "begin()",
                            "run()"
                        ],
                        correctAnswer: 1
                    },
                    {
                        id: 2,
                        type: "code",
                        question: "Viết chương trình in ra dòng chữ 'Xin chào C++'",
                        initialCode: `#include <iostream>\nusing namespace std;\n\nint main() {\n    // Viết code của bạn ở đây\n    \n    return 0;\n}`,
                        testCases: [
                            { input: "", expectedOutput: "Xin chào C++" }
                        ]
                    }
                ]
            },
            {
                id: 2,
                title: "Biến và kiểu dữ liệu",
                status: "in-progress",
                content: `
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Biến trong C++</h3>
                    <p class="mb-4">Biến là vùng nhớ được đặt tên, dùng để lưu trữ dữ liệu. Mỗi biến có một kiểu dữ liệu xác định.</p>
                    
                    <h4 class="text-lg font-bold text-gray-800 mb-2">Khai báo biến</h4>
                    <div class="code-editor mb-4">
                        <pre><code>// Khai báo biến
int age;
float salary;
char grade;
string name;</code></pre>
                    </div>
                    
                    <h4 class="text-lg font-bold text-gray-800 mb-2">Khởi tạo biến</h4>
                    <div class="code-editor mb-4">
                        <pre><code>// Khởi tạo biến
int age = 25;
float salary = 1500.50;
char grade = 'A';
string name = "Nguyen Van A";</code></pre>
                    </div>
                    
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Kiểu dữ liệu cơ bản</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white border border-gray-300">
                            <thead>
                                <tr class="bg-gray-100">
                                    <th class="py-2 px-4 border-b">Kiểu dữ liệu</th>
                                    <th class="py-2 px-4 border-b">Mô tả</th>
                                    <th class="py-2 px-4 border-b">Kích thước</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="py-2 px-4 border-b">int</td>
                                    <td class="py-2 px-4 border-b">Số nguyên</td>
                                    <td class="py-2 px-4 border-b">4 bytes</td>
                                </tr>
                                <tr>
                                    <td class="py-2 px-4 border-b">float</td>
                                    <td class="py-2 px-4 border-b">Số thực dấu phẩy động</td>
                                    <td class="py-2 px-4 border-b">4 bytes</td>
                                </tr>
                                <tr>
                                    <td class="py-2 px-4 border-b">double</td>
                                    <td class="py-2 px-4 border-b">Số thực độ chính xác kép</td>
                                    <td class="py-2 px-4 border-b">8 bytes</td>
                                </tr>
                                <tr>
                                    <td class="py-2 px-4 border-b">char</td>
                                    <td class="py-2 px-4 border-b">Ký tự</td>
                                    <td class="py-2 px-4 border-b">1 byte</td>
                                </tr>
                                <tr>
                                    <td class="py-2 px-4 border-b">bool</td>
                                    <td class="py-2 px-4 border-b">Giá trị logic (true/false)</td>
                                    <td class="py-2 px-4 border-b">1 byte</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                `,
                exercises: [
                    {
                        id: 3,
                        type: "quiz",
                        question: "Kiểu dữ liệu nào dùng để lưu trữ số nguyên?",
                        options: [
                            "float",
                            "int",
                            "char",
                            "string"
                        ],
                        correctAnswer: 1
                    },
                    {
                        id: 4,
                        type: "code",
                        question: "Khai báo và khởi tạo một biến số nguyên có tên 'soNguyen' với giá trị 100",
                        initialCode: `#include <iostream>\nusing namespace std;\n\nint main() {\n    // Khai báo và khởi tạo biến soNguyen\n    \n    cout << soNguyen << endl;\n    return 0;\n}`,
                        testCases: [
                            { input: "", expectedOutput: "100" }
                        ]
                    }
                ]
            },
            {
                id: 3,
                title: "Toán tử và biểu thức",
                status: "not-started",
                content: `
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Toán tử trong C++</h3>
                    <p class="mb-4">C++ cung cấp nhiều loại toán tử để thực hiện các phép toán khác nhau.</p>
                    
                    <h4 class="text-lg font-bold text-gray-800 mb-2">Toán tử số học</h4>
                    <div class="overflow-x-auto mb-4">
                        <table class="min-w-full bg-white border border-gray-300">
                            <thead>
                                <tr class="bg-gray-100">
                                    <th class="py-2 px-4 border-b">Toán tử</th>
                                    <th class="py-2 px-4 border-b">Mô tả</th>
                                    <th class="py-2 px-4 border-b">Ví dụ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="py-2 px-4 border-b">+</td>
                                    <td class="py-2 px-4 border-b">Cộng</td>
                                    <td class="py-2 px-4 border-b">a + b</td>
                                </tr>
                                <tr>
                                    <td class="py-2 px-4 border-b">-</td>
                                    <td class="py-2 px-4 border-b">Trừ</td>
                                    <td class="py-2 px-4 border-b">a - b</td>
                                </tr>
                                <tr>
                                    <td class="py-2 px-4 border-b">*</td>
                                    <td class="py-2 px-4 border-b">Nhân</td>
                                    <td class="py-2 px-4 border-b">a * b</td>
                                </tr>
                                <tr>
                                    <td class="py-2 px-4 border-b">/</td>
                                    <td class="py-2 px-4 border-b">Chia</td>
                                    <td class="py-2 px-4 border-b">a / b</td>
                                </tr>
                                <tr>
                                    <td class="py-2 px-4 border-b">%</td>
                                    <td class="py-2 px-4 border-b">Chia lấy phần dư</td>
                                    <td class="py-2 px-4 border-b">a % b</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <h4 class="text-lg font-bold text-gray-800 mb-2">Toán tử gán</h4>
                    <div class="code-editor mb-4">
                        <pre><code>int a = 10;  // Gán giá trị 10 cho a
a += 5;      // Tương đương a = a + 5
a -= 3;      // Tương đương a = a - 3
a *= 2;      // Tương đương a = a * 2
a /= 4;      // Tương đương a = a / 4
a %= 3;      // Tương đương a = a % 3</code></pre>
                    </div>
                    
                    <h4 class="text-lg font-bold text-gray-800 mb-2">Toán tử so sánh</h4>
                    <div class="code-editor mb-4">
                        <pre><code>int a = 5, b = 10;
bool result;

result = (a == b);  // false
result = (a != b);  // true
result = (a < b);   // true
result = (a > b);   // false
result = (a <= b);  // true
result = (a >= b);  // false</code></pre>
                    </div>
                `,
                exercises: [
                    {
                        id: 5,
                        type: "quiz",
                        question: "Toán tử nào dùng để tính phần dư của phép chia?",
                        options: [
                            "/",
                            "%",
                            "//",
                            "mod"
                        ],
                        correctAnswer: 1
                    },
                    {
                        id: 6,
                        type: "code",
                        question: "Viết chương trình tính tổng, hiệu, tích và thương của hai số nguyên a và b",
                        initialCode: `#include <iostream>\nusing namespace std;\n\nint main() {\n    int a = 15, b = 3;\n    \n    // Tính tổng, hiệu, tích, thương\n    \n    return 0;\n}`,
                        testCases: [
                            { input: "", expectedOutput: "Tổng: 18\nHiệu: 12\nTích: 45\nThương: 5" }
                        ]
                    }
                ]
            },
            // Các mục học khác sẽ được thêm ở đây...
        ];

        // Khởi tạo ứng dụng
        document.addEventListener('DOMContentLoaded', function() {
            // Khởi tạo dữ liệu trong localStorage nếu chưa có
            if (!localStorage.getItem('cpp-course-progress')) {
                const initialProgress = {
                    completedModules: [1],
                    moduleStatus: {
                        1: 'completed',
                        2: 'in-progress',
                        3: 'not-started'
                    },
                    exerciseScores: {
                        1: 10, // Bài tập 1 được chấm 10 điểm
                        2: 8   // Bài tập 2 được chấm 8 điểm
                    },
                    totalScore: 18,
                    averageScore: 9.0
                };
                localStorage.setItem('cpp-course-progress', JSON.stringify(initialProgress));
            }

            // Hiển thị danh sách mục học
            renderModuleList();
            
            // Cập nhật tiến độ
            updateProgress();
            
            // Xử lý sự kiện
            document.getElementById('start-learning').addEventListener('click', showModuleList);
            document.getElementById('module-exercises-btn').addEventListener('click', showExercises);
            document.getElementById('submit-exercises').addEventListener('click', submitExercises);
            document.getElementById('back-to-module').addEventListener('click', showCurrentModule);
            document.getElementById('dark-mode-toggle').addEventListener('click', toggleDarkMode);
            
            // Hiển thị trang chủ mặc định
            showHomePage();
        });

        // Hiển thị danh sách mục học trong sidebar
        function renderModuleList() {
            const moduleList = document.getElementById('module-list');
            moduleList.innerHTML = '';
            
            // Thêm mục "Trang chủ"
            const homeItem = document.createElement('li');
            homeItem.className = 'module-item p-3 rounded-lg cursor-pointer active-module';
            homeItem.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-home text-primary mr-3"></i>
                    <span class="font-medium">Trang chủ</span>
                </div>
            `;
            homeItem.addEventListener('click', showHomePage);
            moduleList.appendChild(homeItem);
            
            // Thêm mục "Bảng tiến độ"
            const progressItem = document.createElement('li');
            progressItem.className = 'module-item p-3 rounded-lg cursor-pointer';
            progressItem.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-chart-line text-primary mr-3"></i>
                    <span class="font-medium">Bảng tiến độ</span>
                </div>
            `;
            progressItem.addEventListener('click', showProgressPage);
            moduleList.appendChild(progressItem);
            
            // Thêm các mục học
            courseModules.forEach(module => {
                const moduleItem = document.createElement('li');
                moduleItem.className = `module-item p-3 rounded-lg cursor-pointer ${module.id === 2 ? 'active-module' : ''}`;
                
                let statusIcon = '❌';
                if (module.status === 'completed') statusIcon = '✅';
                else if (module.status === 'in-progress') statusIcon = '⏳';
                
                moduleItem.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div class="flex items-center">
                            <i class="fas fa-book text-gray-500 mr-3"></i>
                            <span class="font-medium">${module.title}</span>
                        </div>
                        <span>${statusIcon}</span>
                    </div>
                `;
                
                moduleItem.addEventListener('click', () => showModule(module.id));
                moduleList.appendChild(moduleItem);
            });
        }

        // Hiển thị trang chủ
        function showHomePage() {
            document.getElementById('home-page').classList.remove('hidden');
            document.getElementById('module-page').classList.add('hidden');
            document.getElementById('exercises-page').classList.add('hidden');
            document.getElementById('progress-page').classList.add('hidden');
            
            // Cập nhật lớp active trong sidebar
            updateActiveSidebarItem(0);
        }

        // Hiển thị danh sách mục học (từ trang chủ)
        function showModuleList() {
            // Trong thiết kế hiện tại, danh sách mục học đã hiển thị trong sidebar
            // Nên chúng ta sẽ chọn mục đầu tiên để hiển thị
            showModule(1);
        }

        // Hiển thị chi tiết mục học
        function showModule(moduleId) {
            document.getElementById('home-page').classList.add('hidden');
            document.getElementById('module-page').classList.remove('hidden');
            document.getElementById('exercises-page').classList.add('hidden');
            document.getElementById('progress-page').classList.add('hidden');
            
            const module = courseModules.find(m => m.id === moduleId);
            if (module) {
                document.getElementById('module-title').textContent = module.title;
                document.getElementById('module-content').innerHTML = module.content;
                
                // Lưu mục hiện tại
                currentModuleId = moduleId;
                
                // Cập nhật lớp active trong sidebar
                updateActiveSidebarItem(moduleId);
            }
        }

        // Hiển thị mục học hiện tại (từ trang bài tập)
        function showCurrentModule() {
            if (currentModuleId) {
                showModule(currentModuleId);
            }
        }

        // Hiển thị trang bài tập
        function showExercises() {
            document.getElementById('home-page').classList.add('hidden');
            document.getElementById('module-page').classList.add('hidden');
            document.getElementById('exercises-page').classList.remove('hidden');
            document.getElementById('progress-page').classList.add('hidden');
            
            const module = courseModules.find(m => m.id === currentModuleId);
            if (module) {
                document.getElementById('exercises-title').textContent = `Bài tập: ${module.title}`;
                renderExercises(module.exercises);
            }
        }

        // Hiển thị trang tiến độ
        function showProgressPage() {
            document.getElementById('home-page').classList.add('hidden');
            document.getElementById('module-page').classList.add('hidden');
            document.getElementById('exercises-page').classList.add('hidden');
            document.getElementById('progress-page').classList.remove('hidden');
            
            updateProgressBoard();
            
            // Cập nhật lớp active trong sidebar
            updateActiveSidebarItem(-1);
        }

        // Hiển thị bài tập
        function renderExercises(exercises) {
            const container = document.getElementById('exercises-container');
            container.innerHTML = '';
            
            exercises.forEach((exercise, index) => {
                const exerciseElement = document.createElement('div');
                exerciseElement.className = 'mb-8 p-4 border rounded-lg';
                exerciseElement.innerHTML = `
                    <h3 class="text-lg font-bold text-gray-800 mb-3">Bài ${index + 1}: ${exercise.question}</h3>
                    <div class="exercise-content" id="exercise-${exercise.id}"></div>
                `;
                
                container.appendChild(exerciseElement);
                
                if (exercise.type === 'quiz') {
                    renderQuizExercise(exercise);
                } else if (exercise.type === 'code') {
                    renderCodeExercise(exercise);
                }
            });
        }

        // Hiển thị bài tập trắc nghiệm
        function renderQuizExercise(exercise) {
            const container = document.getElementById(`exercise-${exercise.id}`);
            container.innerHTML = '';
            
            exercise.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'quiz-option mb-2 p-3 border rounded-lg';
                optionElement.innerHTML = `
                    <div class="flex items-center">
                        <input type="radio" name="exercise-${exercise.id}" value="${index}" class="mr-3">
                        <span>${option}</span>
                    </div>
                `;
                container.appendChild(optionElement);
            });
        }

        // Hiển thị bài tập lập trình
        function renderCodeExercise(exercise) {
            const container = document.getElementById(`exercise-${exercise.id}`);
            container.innerHTML = `
                <div class="code-editor mb-3">
                    <textarea class="w-full h-40 bg-gray-800 text-white p-3 rounded" id="code-${exercise.id}">${exercise.initialCode}</textarea>
                </div>
                <div class="bg-gray-100 p-3 rounded">
                    <h4 class="font-bold mb-2">Kết quả mong đợi:</h4>
                    <pre class="bg-white p-2 rounded">${exercise.testCases[0].expectedOutput}</pre>
                </div>
            `;
        }

        // Nộp bài tập
        function submitExercises() {
            const module = courseModules.find(m => m.id === currentModuleId);
            if (!module) return;
            
            let totalScore = 0;
            let maxScore = module.exercises.length * 10;
            
            module.exercises.forEach(exercise => {
                if (exercise.type === 'quiz') {
                    const selectedOption = document.querySelector(`input[name="exercise-${exercise.id}"]:checked`);
                    if (selectedOption && parseInt(selectedOption.value) === exercise.correctAnswer) {
                        totalScore += 10;
                        markQuizAnswer(exercise.id, parseInt(selectedOption.value), true);
                    } else if (selectedOption) {
                        markQuizAnswer(exercise.id, parseInt(selectedOption.value), false);
                    }
                } else if (exercise.type === 'code') {
                    // Trong thực tế, chúng ta sẽ gửi code đến API để chấm điểm
                    // Ở đây chúng ta giả lập kết quả
                    const code = document.getElementById(`code-${exercise.id}`).value;
                    if (code.includes('Xin chào C++') || code.includes('soNguyen = 100') || 
                        code.includes('Tổng') || code.includes('Hiệu') || code.includes('Tích') || code.includes('Thương')) {
                        totalScore += 8; // Giả lập điểm
                        markCodeResult(exercise.id, true);
                    } else {
                        markCodeResult(exercise.id, false);
                    }
                }
            });
            
            // Hiển thị kết quả
            alert(`Bạn đã hoàn thành bài tập!\nĐiểm số: ${totalScore}/${maxScore}`);
            
            // Cập nhật tiến độ
            updateProgressAfterSubmission(module.id, totalScore, maxScore);
        }

        // Đánh dấu kết quả bài tập trắc nghiệm
        function markQuizAnswer(exerciseId, selectedOption, isCorrect) {
            const options = document.querySelectorAll(`input[name="exercise-${exerciseId}"]`);
            options.forEach((option, index) => {
                const parent = option.parentElement.parentElement;
                if (index === selectedOption) {
                    parent.classList.add(isCorrect ? 'correct-answer' : 'wrong-answer');
                }
                option.disabled = true;
            });
        }

        // Đánh dấu kết quả bài tập code
        function markCodeResult(exerciseId, isCorrect) {
            const textarea = document.getElementById(`code-${exerciseId}`);
            if (isCorrect) {
                textarea.classList.add('correct-answer');
            } else {
                textarea.classList.add('wrong-answer');
            }
            textarea.disabled = true;
        }

        // Cập nhật tiến độ sau khi nộp bài
        function updateProgressAfterSubmission(moduleId, score, maxScore) {
            const progress = JSON.parse(localStorage.getItem('cpp-course-progress'));
            
            // Đánh dấu mục là đã hoàn thành nếu chưa
            if (!progress.completedModules.includes(moduleId)) {
                progress.completedModules.push(moduleId);
            }
            
            // Cập nhật trạng thái mục
            progress.moduleStatus[moduleId] = 'completed';
            
            // Cập nhật điểm số (giả lập)
            const module = courseModules.find(m => m.id === moduleId);
            module.exercises.forEach(exercise => {
                progress.exerciseScores[exercise.id] = exercise.type === 'quiz' ? 10 : 8;
            });
            
            // Tính lại tổng điểm và điểm trung bình
            const exerciseIds = Object.keys(progress.exerciseScores);
            progress.totalScore = exerciseIds.reduce((sum, id) => sum + progress.exerciseScores[id], 0);
            progress.averageScore = progress.totalScore / exerciseIds.length;
            
            // Lưu lại
            localStorage.setItem('cpp-course-progress', JSON.stringify(progress));
            
            // Cập nhật giao diện
            updateProgress();
            renderModuleList();
        }

        // Cập nhật tiến độ tổng thể
        function updateProgress() {
            const progress = JSON.parse(localStorage.getItem('cpp-course-progress'));
            const completedCount = progress.completedModules.length;
            const totalCount = courseModules.length;
            const percent = Math.round((completedCount / totalCount) * 100);
            
            // Cập nhật thanh tiến trình
            document.getElementById('overall-progress').style.width = `${percent}%`;
            document.getElementById('home-progress-bar').style.width = `${percent}%`;
            
            // Cập nhật số liệu
            document.getElementById('progress-percent').textContent = `${percent}%`;
            document.getElementById('completed-modules').textContent = completedCount;
        }

        // Cập nhật bảng tiến độ
        function updateProgressBoard() {
            const progress = JSON.parse(localStorage.getItem('cpp-course-progress'));
            const completedCount = progress.completedModules.length;
            const totalCount = courseModules.length;
            const percent = Math.round((completedCount / totalCount) * 100);
            const exerciseCount = Object.keys(progress.exerciseScores).length;
            
            // Cập nhật số liệu thống kê
            document.getElementById('stats-modules').textContent = completedCount;
            document.getElementById('stats-exercises').textContent = exerciseCount;
            document.getElementById('stats-average').textContent = progress.averageScore.toFixed(1);
            document.getElementById('stats-completion').textContent = `${percent}%`;
            document.getElementById('stats-progress-bar').style.width = `${percent}%`;
            
            // Cập nhật bảng chi tiết
            const tableBody = document.getElementById('progress-table-body');
            tableBody.innerHTML = '';
            
            courseModules.forEach(module => {
                const row = document.createElement('tr');
                
                let statusText = '❌ Chưa học';
                let score = '-';
                let date = '-';
                
                if (progress.moduleStatus[module.id] === 'completed') {
                    statusText = '✅ Hoàn thành';
                    
                    // Tính điểm trung bình của mục
                    const moduleExercises = module.exercises;
                    let moduleScore = 0;
                    let moduleExerciseCount = 0;
                    
                    moduleExercises.forEach(exercise => {
                        if (progress.exerciseScores[exercise.id]) {
                            moduleScore += progress.exerciseScores[exercise.id];
                            moduleExerciseCount++;
                        }
                    });
                    
                    if (moduleExerciseCount > 0) {
                        score = (moduleScore / moduleExerciseCount).toFixed(1);
                    }
                    
                    date = 'Hôm nay';
                } else if (progress.moduleStatus[module.id] === 'in-progress') {
                    statusText = '⏳ Đang học';
                }
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">${module.title}</td>
                    <td class="px-6 py-4 whitespace-nowrap">${statusText}</td>
                    <td class="px-6 py-4 whitespace-nowrap">${score}</td>
                    <td class="px-6 py-4 whitespace-nowrap">${date}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Cập nhật mục active trong sidebar
        function updateActiveSidebarItem(moduleId) {
            const items = document.querySelectorAll('.module-item');
            items.forEach((item, index) => {
                if (index === 0 && moduleId === 0) {
                    item.classList.add('active-module');
                } else if (index === 1 && moduleId === -1) {
                    item.classList.add('active-module');
                } else if (index > 1) {
                    const itemModuleId = courseModules[index - 2].id;
                    if (itemModuleId === moduleId) {
                        item.classList.add('active-module');
                    } else {
                        item.classList.remove('active-module');
                    }
                } else {
                    item.classList.remove('active-module');
                }
            });
        }

        // Chuyển đổi chế độ Dark/Light
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const icon = document.querySelector('#dark-mode-toggle i');
            if (document.body.classList.contains('dark-mode')) {
                document.body.classList.add('bg-gray-900');
                document.body.classList.remove('bg-gray-50');
                icon.classList.remove('fa-moon');
                icon.classList.add('fa-sun');
            } else {
                document.body.classList.remove('bg-gray-900');
                document.body.classList.add('bg-gray-50');
                icon.classList.remove('fa-sun');
                icon.classList.add('fa-moon');
            }
        }

        // Biến toàn cục
        let currentModuleId = 1;
    </script>
</body>
</html>
